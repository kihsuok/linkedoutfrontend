{"ast":null,"code":"import _objectSpread from\"C:/Projects/linkedout/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"C:/Projects/linkedout/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Projects/linkedout/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Projects/linkedout/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Projects/linkedout/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useCallback}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import AdminNav from'./AdminNav';import JobCard from'./AdminJobCard';import jwt from'jsonwebtoken';import{DragDropContext,Droppable,Draggable}from'react-beautiful-dnd';import'./cssfiles/adminboard.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AdminBoard(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var nav=useNavigate();useEffect(function(){var checkAuthorization=function checkAuthorization(){console.log('AUTHENTICATING');var token=localStorage.getItem('token');if(token){var admin=jwt.decode(token);console.log('USER WHILE AUTHENTICATING : ',admin);if(!admin||!admin.isAdmin){localStorage.removeItem('token');nav('/admin-login');}else{setEmail(admin.email);}}else nav('/admin-login');};checkAuthorization();},[nav]);var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),jobs=_useState4[0],setJobs=_useState4[1];useEffect(function(){function fetchJobs(){return _fetchJobs.apply(this,arguments);}function _fetchJobs(){_fetchJobs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,jobs,newres,order,sortedJobs;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('https://linkedoutbackend.onrender.com/admin/jobs');case 2:res=_context.sent;jobs=res.data.jobs;_context.next=6;return axios.get('https://linkedoutbackend.onrender.com/admin/getorder');case 6:newres=_context.sent;order=newres.data.order;sortedJobs=[];order.forEach(function(jobId){var job=jobs.find(function(job){return job.id===jobId;});if(job){sortedJobs.push(job);}});setJobs(sortedJobs);case 11:case\"end\":return _context.stop();}}},_callee);}));return _fetchJobs.apply(this,arguments);}fetchJobs();},[]);var handleDrop=function handleDrop(droppedItem){// Ignore drop outside droppable container\nif(!droppedItem.destination)return;var updatedList=_toConsumableArray(jobs);// Remove dragged item\nvar _updatedList$splice=updatedList.splice(droppedItem.source.index,1),_updatedList$splice2=_slicedToArray(_updatedList$splice,1),reorderedItem=_updatedList$splice2[0];// Add dropped item\nupdatedList.splice(droppedItem.destination.index,0,reorderedItem);// Update State\nsetJobs(updatedList);var newOrder=[];updatedList.forEach(function(item){newOrder.push(item.id);// or newOrder.push(item._id);\n});function updateOrder(){return _updateOrder.apply(this,arguments);}function _updateOrder(){_updateOrder=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('https://linkedoutbackend.onrender.com/admin/orderupdate',{displayorder:newOrder});case 2:res=_context2.sent;console.log(res);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _updateOrder.apply(this,arguments);}updateOrder();};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(AdminNav,{}),/*#__PURE__*/_jsx(DragDropContext,{onDragEnd:handleDrop,children:/*#__PURE__*/_jsx(Droppable,{droppableId:\"list-container\",children:function children(provided){return/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({className:\"list-container\",id:\"adminboard\"},provided.droppableProps),{},{ref:provided.innerRef,children:[jobs.map(function(job,index){return/*#__PURE__*/_jsx(Draggable,{draggableId:job._id,index:index,children:function children(provided){return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread(_objectSpread({className:\"item-container\"},provided.draggableProps),provided.dragHandleProps),{},{ref:provided.innerRef,children:/*#__PURE__*/_jsx(JobCard,{id:job.id,title:job.title,location:job.location,deadline:job.deadline,contact:job.contact,email:email,archived:job.archived})}));}},job.id);}),provided.placeholder]}));}})})]});}export default AdminBoard;","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","useNavigate","AdminNav","JobCard","jwt","DragDropContext","Droppable","Draggable","AdminBoard","email","setEmail","nav","checkAuthorization","console","log","token","localStorage","getItem","admin","decode","isAdmin","removeItem","jobs","setJobs","fetchJobs","get","res","data","newres","order","sortedJobs","forEach","jobId","job","find","id","push","handleDrop","droppedItem","destination","updatedList","splice","source","index","reorderedItem","newOrder","item","updateOrder","post","displayorder","provided","droppableProps","innerRef","map","_id","draggableProps","dragHandleProps","title","location","deadline","contact","archived","placeholder"],"sources":["C:/Projects/linkedout/client/src/components/admin/AdminBoard.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react'\r\nimport axios from 'axios'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport AdminNav from './AdminNav'\r\nimport JobCard from './AdminJobCard'\r\nimport jwt from 'jsonwebtoken'\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\r\nimport './cssfiles/adminboard.css'\r\nfunction AdminBoard() {\r\n  const [email, setEmail] = useState('')\r\n\r\n  const nav = useNavigate()\r\n\r\n  useEffect(() => {\r\n    const checkAuthorization = () => {\r\n      console.log('AUTHENTICATING')\r\n      const token = localStorage.getItem('token')\r\n      if (token) {\r\n        const admin = jwt.decode(token)\r\n        console.log('USER WHILE AUTHENTICATING : ', admin)\r\n        if (!admin || !admin.isAdmin) {\r\n          localStorage.removeItem('token')\r\n          nav('/admin-login')\r\n        } else {\r\n          setEmail(admin.email)\r\n        }\r\n      } else nav('/admin-login')\r\n    }\r\n    checkAuthorization()\r\n  }, [nav])\r\n\r\n  const [jobs, setJobs] = useState([])\r\n\r\n  useEffect(() => {\r\n    async function fetchJobs() {\r\n      const res = await axios.get('https://linkedoutbackend.onrender.com/admin/jobs')\r\n      const jobs = res.data.jobs\r\n      const newres = await axios.get('https://linkedoutbackend.onrender.com/admin/getorder')\r\n      const order= newres.data.order;\r\n\r\n      const sortedJobs = [];\r\n\r\n      order.forEach((jobId) => {\r\n        const job = jobs.find((job) => job.id === jobId);\r\n        if (job) {\r\n          sortedJobs.push(job);\r\n        }\r\n      });\r\n\r\n      setJobs(sortedJobs)\r\n    }\r\n\r\n    fetchJobs()\r\n  }, [])\r\n\r\n  const handleDrop = (droppedItem) => {\r\n    // Ignore drop outside droppable container\r\n    if (!droppedItem.destination) return;\r\n    var updatedList = [...jobs];\r\n    // Remove dragged item\r\n    const [reorderedItem] = updatedList.splice(droppedItem.source.index, 1);\r\n    // Add dropped item\r\n    updatedList.splice(droppedItem.destination.index, 0, reorderedItem);\r\n    // Update State\r\n    setJobs(updatedList);\r\n    let newOrder = [];\r\n    updatedList.forEach((item) => {\r\n      newOrder.push(item.id); // or newOrder.push(item._id);\r\n    });\r\n\r\n    \r\n\r\n    async function updateOrder() {\r\n      const res = await axios.post(\r\n        'https://linkedoutbackend.onrender.com/admin/orderupdate',\r\n        { displayorder: newOrder }\r\n      )\r\n      console.log(res);\r\n\r\n    }\r\n    updateOrder()\r\n\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <AdminNav />\r\n      <DragDropContext onDragEnd={handleDrop}>\r\n        <Droppable droppableId=\"list-container\">\r\n          {(provided) => (\r\n            <div className=\"list-container\" id=\"adminboard\" {...provided.droppableProps} ref={provided.innerRef}>\r\n              {jobs.map((job, index) => (\r\n                <Draggable key={job.id} draggableId={job._id} index={index}>\r\n                  {(provided) => (\r\n                    <div\r\n                      className=\"item-container\"\r\n                      {...provided.draggableProps}\r\n                      {...provided.dragHandleProps}\r\n                      ref={provided.innerRef}\r\n                      \r\n                    >\r\n                      <JobCard\r\n                        id={job.id}\r\n                        title={job.title}\r\n                        location={job.location}\r\n                        deadline={job.deadline}\r\n                        contact={job.contact}\r\n                        email={email}\r\n                        archived={job.archived}\r\n                      />\r\n                      {/* {index} */}\r\n                    </div>\r\n                  )}\r\n                </Draggable>\r\n              ))}\r\n              {provided.placeholder}\r\n            </div>\r\n          )}\r\n        </Droppable>\r\n      </DragDropContext>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default AdminBoard\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}